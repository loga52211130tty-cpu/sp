<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>智慧藥盒管理</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #f9f9f9; }
        h1 { color: #333; }
        button { padding: 10px 20px; margin: 10px 5px 10px 0; font-size: 16px; cursor: pointer; }
        #output { margin-top: 20px; white-space: pre-wrap; background: #fff; padding: 10px; border-radius: 5px; border: 1px solid #ccc; }
    </style>
</head>
<body>
    <h1>智慧藥盒資料操作</h1>
    <button onclick="readData()">讀取試算表資料</button>
    <button onclick="writeData()">寫入範例資料</button>
    <div id="output">操作結果會顯示在這裡</div>

    <script>
        const scriptURL = "https://script.google.com/macros/s/AKfycbzxBXGJLEg861dSxTqZPJp-yoQRu4_tdlpKCte1N3kCuamGmBNZAsqIzhb_HhYhVML8/exec";

        // 讀取資料
        async function readData() {
            try {
                const response = await fetch(scriptURL + "?action=read");
                const data = await response.json();
                document.getElementById("output").textContent = JSON.stringify(data, null, 2);
            } catch (err) {
                document.getElementById("output").textContent = "讀取失敗：" + err;
            }
        }

        // 寫入資料
        async function writeData() {
            try {
                const payload = {
                    action: "write",
                    data: { name: "測試藥品", time: "08:00" }
                };
                const response = await fetch(scriptURL, {
                    method: "POST",
                    body: JSON.stringify(payload),
                    headers: { "Content-Type": "application/json" }
                });
                const result = await response.json();
                document.getElementById("output").textContent = JSON.stringify(result, null, 2);
            } catch (err) {
                document.getElementById("output").textContent = "寫入失敗：" + err;
            }
        }
    </script>
</body>
</html>

